table_appellation_taxon <- dbGetQuery(con, "SELECT cd_apt,nom_latin_apt,cd_niv_apt FROM tsa_appellation_taxon_apt" )
df_noms_taxons <- table_appellation_taxon %>%
inner_join(df_niveau_taxonomique, by=c("cd_niv_apt")) %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(df_code_taxon_final,  by =c("cd_apt"="code_retenu")) %>%
dplyr::rename("code_retenu"=cd_apt,"niveau_taxo"=LbElement,"nom_taxo" = nom_latin_apt) %>%
as_tibble() %>%
dplyr::select(-c(cd_niv_apt,Inconnu))
################################### prélèvement biologique #####################################################
table_zone_inv <- dbGetQuery(con,"SELECT * FROM zone_inv")
table_prelevement_bio <- dbGetQuery(
con,
"
SELECT
zone_inv,
pb.cd_zone,
libelle_zone,
pb.id_point_prelev,
cd_apt,
code_lac,
confer,
cd_remarque,
date_debut_prel_bio date,
pb.cd_type_prel_bio,
id_campagne_diag,
libelle,
abondance,
biovolume,
surface,
volume,
sym_urf
FROM prelevement_biologique pb
LEFT JOIN type_prel_bio tp
ON pb.cd_type_prel_bio = tp.cd_type_prel_bio
LEFT JOIN taxon_denombre td
ON pb.id_prelev_bio = td.id_prelev_bio
INNER JOIN tsa_appellation_taxon_apt ta
ON td.cd_taxon = ta.cd_apt
INNER JOIN point_prel_eaux_surf ppes
ON ppes.id_point_prelev = pb.id_point_prelev
INNER JOIN tsa_unite_mesure_urf tumu
ON tumu.cd_urf = td.cd_unite_bio
LEFT JOIN zone_verticale_prospecte zvp
ON zvp.cd_zone = pb.cd_zone
LEFT JOIN biovolume b
ON b.id_taxon_denombre = td.id_taxon_denombre
WHERE td.cd_taxon IS NOT NULL
AND sym_urf <> 'Unité inconnue'
AND cd_apt <> '34105'
AND libelle <> 'Faune associée aux prélevements IOBL (IOBL+), liaison avec IOBL via ID_PointPrelev'
AND libelle <> 'Oligochètes IOBL'
AND libelle <> 'Mollusques IMOL'
"
)
con
drv <-
dbDriver("PostgreSQL") #interface avec système de gestion de base de données
con <- dbConnect(
drv,
dbname = "bd_plando",
host = "195.221.114.149",
port = 5434,
user = "theo.marechal",
password = theo
)
drv <-
dbDriver("PostgreSQL") #interface avec système de gestion de base de données
con <- dbConnect(
drv,
dbname = "bd_plando",
host = "195.221.114.149",
port = 5434,
user = "theo.marechal",
password = theo
)
source("/home/theo/Bureau/scriptR/librairies.R")
drv <-
dbDriver("PostgreSQL") #interface avec système de gestion de base de données
con <- dbConnect(
drv,
dbname = "bd_plando",
host = "195.221.114.149",
port = 5434,
user = "theo.marechal",
password = theo
)
df_niveau_taxonomique <-
read_csv("/home/theo/Bureau/Data/df_code_niveau_taxonomique_SANDRE.csv") %>%
mutate(cd_niv_apt = as.character(cd_niv_apt))
df_code_taxon_final <-
read.csv("/home/theo/Bureau/Data/code_taxons.csv")
table_appellation_taxon <- dbGetQuery(con, "SELECT cd_apt,nom_latin_apt,cd_niv_apt FROM tsa_appellation_taxon_apt" )
df_noms_taxons <- table_appellation_taxon %>%
inner_join(df_niveau_taxonomique, by=c("cd_niv_apt")) %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(df_code_taxon_final,  by =c("cd_apt"="code_retenu")) %>%
dplyr::rename("code_retenu"=cd_apt,"niveau_taxo"=LbElement,"nom_taxo" = nom_latin_apt) %>%
as_tibble() %>%
dplyr::select(-c(cd_niv_apt,Inconnu))
################################### prélèvement biologique #####################################################
table_zone_inv <- dbGetQuery(con,"SELECT * FROM zone_inv")
table_biovolume <-dbGetQuery(con,"SELECT * FROM biovolume WHERE biovolume >0")
table_prelevement_bio <- dbGetQuery(
con,
"
SELECT
zone_inv,
pb.cd_zone,
libelle_zone,
pb.id_point_prelev,
cd_apt,
code_lac,
confer,
cd_remarque,
date_debut_prel_bio date,
pb.cd_type_prel_bio,
id_campagne_diag,
libelle,
abondance,
biovolume,
surface,
volume,
sym_urf
FROM prelevement_biologique pb
LEFT JOIN type_prel_bio tp
ON pb.cd_type_prel_bio = tp.cd_type_prel_bio
LEFT JOIN taxon_denombre td
ON pb.id_prelev_bio = td.id_prelev_bio
INNER JOIN tsa_appellation_taxon_apt ta
ON td.cd_taxon = ta.cd_apt
INNER JOIN point_prel_eaux_surf ppes
ON ppes.id_point_prelev = pb.id_point_prelev
INNER JOIN tsa_unite_mesure_urf tumu
ON tumu.cd_urf = td.cd_unite_bio
LEFT JOIN zone_verticale_prospecte zvp
ON zvp.cd_zone = pb.cd_zone
LEFT JOIN biovolume b
ON b.id_taxon_denombre = td.id_taxon_denombre
WHERE td.cd_taxon IS NOT NULL
AND sym_urf <> 'Unité inconnue'
AND cd_apt <> '34105'
AND libelle <> 'Faune associée aux prélevements IOBL (IOBL+), liaison avec IOBL via ID_PointPrelev'
AND libelle <> 'Oligochètes IOBL'
AND libelle <> 'Mollusques IMOL'
"
)
3/15*10000
3/15/10000
3/(15/10000)
###### phytoplanctons avec les données de christophe
lien_1 <- read_csv("/home/theo/Bureau/Data/Données traits/Synthèse traits/phytoplancton/lien_1.csv")
lien_2 <- read_csv("/home/theo/Bureau/Data/Données traits/Synthèse traits/phytoplancton/lien_2.csv")
nom_phyto <- inner_join(lien_1, lien_2, by = "cd_apa") %>% distinct()
nom_phyto$nom_ref %>%  unique()
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
filter(is.na(abondance) != TRUE, confer != TRUE,biovolume>0) %>%
dplyr::select(-c(zone_inv,confer,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
df_phytoplancton_christophe
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
filter(is.na(abondance) != TRUE, confer != TRUE,biovolume>0) %>%
dplyr::select(-c(zone_inv,confer,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
table_prelevement_bio
nom_phyto
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
filter(is.na(abondance) != TRUE, confer != TRUE,biovolume>0) %>%
dplyr::select(-c(zone_inv,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
)
df_phytoplancton_christophe
df_phytoplancton_christophe
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
filter(is.na(abondance) != TRUE) %>%
dplyr::select(-c(zone_inv,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
filter(is.na(abondance) != TRUE) %>%
dplyr::select(-c(zone_inv,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
)
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
dplyr::filter(is.na(abondance) != TRUE) %>%
dplyr::select(-c(zone_inv,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
filter(date >= "2005-01-01")
df_phytoplancton_christophe <- table_prelevement_bio %>%
mutate(cd_apt = as.integer(cd_apt)) %>%
inner_join(nom_phyto, by = c("cd_apt" = "cd_taxon")) %>%
mutate(
unite = "n/m²",
abondance = case_when(
sym_urf == "n/(0,1m²)" ~ abondance * 10,
sym_urf == "n" ~ abondance / (surface / 10000),
TRUE ~ abondance
),
libelle = "phytoplancton"
) %>%
dplyr::filter(is.na(abondance) != TRUE) %>%
dplyr::select(-c(zone_inv,cd_remarque,cd_type_prel_bio,surface,volume,sym_urf)) %>%
dplyr::filter(date >= "2005-01-01")
df_phytoplancton_christophe
df_phytoplancton_christophe
###################################################################################################################################
########
########                        TRAITS PHYTOPLANCTONS
########
####################################################################################################################################
df_bdd_traits_phyto <- read_csv("/home/theo/Bureau/Data/Données traits/Synthèse traits/phytoplancton/traits_finaux/traits_phyto_bdd.csv")
df_bdd_traits_phyto
df_espece_phyto <-df_phytoplancton_christophe %>% dplyr::select(nom_ref) %>% distinct() %>% na.omit()
df_espece_phyto
df_traits_phyto <- inner_join(df_espece_phyto,df_bdd_traits_phyto, by = c("nom_ref"="Species"))
df_traits_phyto
var_type <- map_dfc(df_traits_phyto,~typeof(.)) %>%
t()%>%
as.data.frame() %>%
mutate(variable = row.names(.)) %>%
arrange(V1) %>%
.$variable
df_traits_phyto <- df_traits_phyto %>% dplyr::select(all_of(var_type))
df_traits_phyto
df_traits_phyto <- df_traits_phyto %>% dplyr::select(all_of(var_type)) %>% as_tibble()
df_traits_phyto
df_bdd_traits_phyto
df_traits_phyto <- inner_join(df_espece_phyto,df_bdd_traits_phyto, by = c("nom_ref"="Taxa_Name"))
df_traits_phyto
var_type <- map_dfc(df_traits_phyto,~typeof(.)) %>%
t()%>%
as.data.frame() %>%
mutate(variable = row.names(.)) %>%
arrange(V1) %>%
.$variable
df_traits_phyto <- df_traits_phyto %>% dplyr::select(all_of(var_type)) %>% as_tibble()
df_traits_phyto
table_traits <- read_csv("/home/theo/Bureau/Data/Données traits/Synthèse traits/phytoplancton/traits_finaux/traits_phyto_bdd.csv")
table_traits
df_bdd_traits_phyto
df_espece_phyto <-df_phytoplancton_christophe %>% dplyr::select(nom_ref) %>% distinct() %>% na.omit()
df_espece_phyto
df_espece_phyto <-df_phytoplancton_christophe %>% dplyr::select(nom_ref) %>% distinct() %>% na.omit() %>% as_tibble()
df_espece_phyto
df_traits_phyto <- inner_join(df_espece_phyto,df_bdd_traits_phyto, by = c("nom_ref"="Taxa_Name"))
df_traits_phyto
write.csv(df_phytoplancton_christophe, "/home/theo/Bureau/Data/Données finales/communautés/df_phytoplanctons",row.names = FALSE)
df_traits_phyto
write.csv(df_traits_phyto,
file = "/home/theo/Bureau/Data/Données traits/Synthèse traits/phytoplancton/traits_finaux/traits_phyto.csv",
row.names = FALSE)
com_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/communautés/df_poissons.csv")
com_macrophytes <- read_csv("/home/theo/Bureau/Data/Données finales/communautés/df_macrophytes.csv")
com_macrophytes
com_phytoplancton
com_macroinvertebres
traits_macrophytes <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_macrophytes_final.csv")
traits_macrophytes
traits_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_poissons_jointure.csv")
traits_poissons
traits_phytoplancton <- read_csv("/home/theo/Bureau/Data/Données finales/communautés/traits_phyto.csv")
traits_phytoplancton <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_phyto.csv")
traits_phytoplancton
traits_macroinvertebres <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_macroinvertebres.csv")
traits_macroinvertebres
traits_poissons
traits_poissons %>% vis_dat()
traits_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_poissons_jointure.csv") %>% dplyr::select(-duree_stade_larvaire)
traits_poissons %>% vis_dat()
traits_poissons %>% na.omit()
traits_poissons %>% na.omit() %>% dudi.hillsmith(nf=2)
traits_poissons %>% na.omit() %>% dudi.mix(nf=2)
traits_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_poissons_jointure.csv") %>%
mutate_if(is.character,as.factor) %>%
dplyr::select(-duree_stade_larvaire)
traits_poissons %>% na.omit() %>% dudi.mix(nf=2)
traits_poissons %>% na.omit() %>% dudi.mix(nf=2) %>% scatter()
traits_poissons %>% na.omit() %>% dudi.hillsmith(nf=2) %>% scatter()
traits_poissons %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith(nf=2) %>% scatter()
traits_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_poissons_jointure.csv") %>%
mutate_if(is.character,as.factor) %>%
dplyr::select(-duree_stade_larvaire,famille)
traits_poissons %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith(nf=2) %>% scatter()
traits_poissons
traits_poissons <- read_csv("/home/theo/Bureau/Data/Données finales/traits/traits_poissons_jointure.csv") %>%
mutate_if(is.character,as.factor) %>%
dplyr::select(-c(duree_stade_larvaire,famille))
traits_poissons %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith(nf=2) %>% scatter()
?scatter
traits_poissons %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith(nf=2) %>% biplot()
?biplot
traits_macrophytes
traits_macrophytes%>% vis_dat()
traits_macrophytes%>% vis_miss()
traits_macrophytes$LEDA_plant_growth_form
traits_macrophytes$LEDA_plant_growth_form %>% na.omit()
traits_macrophytes$LEDA_plant_growth_form %>% na.omit() %>% length()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()==TRUE
traits_macrophytes$LEDA_plant_growth_form %>% is.na()==TRUE %>% length()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()==TRUE %>% count()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()==TRUE %>% sum()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()==TRUE %>%as.numeric()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()%>%as.numeric()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()%>% sum()
traits_macrophytes$LEDA_plant_growth_form %>% is.na()%>% sum() /traits_macrophytes$LEDA_plant_growth_form %>% na.omit() %>% length()
traits_macrophytes%>% select_if(. %>%  is.na()%>% sum() / . %>% na.omit() %>% length <0.3)
traits_macrophytes%>% select_if((. %>%  is.na()%>% sum() / . %>% na.omit() %>% length) <0.3)
traits_macrophytes%>% select_if((. %>%  is.na()%>% sum() / . %>% na.omit() %>% length()) <0.3)
traits_macrophytes%>% select_if(is.na() %>% sum() / na.omit() %>% length()) <0.3)
traits_macrophytes%>% select_if(is.na() %>% sum() / na.omit() %>% length() <0.3)
traits_macrophytes%>% select_if(is.na %>% sum() / na.omit %>% length() <0.3)
traits_macrophytes%>% select_if(is.na %>% sum(.) / na.omit %>% length(.) <0.3)
traits_macrophytes%>% select_if(is.na %>% sum / na.omit %>% length <0.3)
traits_macrophytes%>% map_df(~ is.na() %>% sum() / na.omit() %>% length())
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length())
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% select_if(map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3)
traits_macrophytes%>% select_if(~map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3)
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% select_if(==TRUE)
traits_macrophytes%>% map_df(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% select_if(TRUE)
map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% select(which(map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) )
traits_macrophytes%>% select(which(map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) ))
traits_macrophytes%>% select(which(map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) ))
traits_macrophytes%>% select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) ))
traits_macrophytes%>% which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) )
traits_macrophytes%>% map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3)
traits_macrophytes%>% which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()))<0.3)
traits_macrophytes%>% which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3)
map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length())<0.3
map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length())
map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% which(map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3))
traits_macrophytes
traits_macrophytes%>% which(map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.data.frame())
traits_macrophytes%>% which(map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)==TRUE)
map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)==TRUE
map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3)
traits_macrophytes%>% which(map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())
which(map_lgl(traits_macrophytes,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())
traits_macrophytes %>% select(which(map_lgl(~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% select(which(map_lgl(.,~ is.na(.x) %>% sum() / na.omit(.x) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.x) %>% sum() / na.omit(.x) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.1) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.2) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector()))
traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())) %>% na.omit()
a <- traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())) %>% na.omit()
a <- traits_macrophytes %>% dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())) %>% na.omit() %>% dplyr::select(-nom_taxo)
dudi.hillsmith(a,nf=2)
a
a <- traits_macrophytes %>%
dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<0.3) %>% as.vector())) %>%
na.omit() %>%
dplyr::select(-nom_taxo) %>%
mutate_if(is.character,as.factor)
a
dudi.hillsmith(a,nf=2)
dudi.hillsmith(a,nf=2) %>% biplot()
fun_select_NA <- function(df,seuil_NA = 0.3){
df %>%
dplyr::select(which(map_lgl(.,~ is.na(.) %>% sum() / na.omit(.) %>% length()<seuil_NA) %>% as.vector())) %>%
mutate_if(is.character,as.factor)
}
fun_select_NA(traits_phytoplancton)
fun_select_NA <- function(df,seuil_NA = 0.3){
df %>%
dplyr::select(
which(
map_lgl(.,
~ is.na(.) %>% sum() / na.omit(.) %>% length()<seuil_NA
) %>%
as.vector()
)
) %>%
mutate_if(is.character,as.factor)
}
traits_macroinvertebres
traits_macroinvertebres$nom_taxo %>% unique()
com_macroinvertebres$nom_taxo
com_macroinvertebres$nom_taxo %>% unique()
com_macroinvertebres$nom_taxo %>% unique() %in% traits_macroinvertebres$nom_taxo %>% unique()
com_macroinvertebres %>% dplyr::filter(nom_taxo %in% traits_macroinvertebres$nom_taxo %>% unique())
traits_macroinvertebres$nom_taxo %>% unique()
com_macroinvertebres
com_macroinvertebres %>% dplyr::filter(nom_taxo %in% traits_macroinvertebres$nom_taxo %>% unique())
com_macroinvertebres dplyr::select(nom_taxo)%>% distinct() %>% dplyr::filter(nom_taxo %in% traits_macroinvertebres$nom_taxo %>% unique())
com_macroinvertebres dplyr::select(nom_taxo)%>% distinct()
com_macroinvertebres %>% dplyr::select(nom_taxo)%>% distinct() %>% dplyr::filter(nom_taxo %in% traits_macroinvertebres$nom_taxo %>% unique())
com_macroinvertebres %>% dplyr::select(nom_taxo)%>% distinct()
com_macroinvertebres %>%
dplyr::select(nom_taxo)%>%
distinct() %>%
dplyr::filter(nom_taxo %in% c(traits_macroinvertebres$nom_taxo %>% unique()))
com_macroinvertebres %>%
dplyr::select(nom_taxo)%>%
distinct() %>%
dplyr::filter(!nom_taxo %in% c(traits_macroinvertebres$nom_taxo %>% unique()))
com_macroinvertebres %>%
dplyr::select(nom_taxo)%>%
distinct() %>%
dplyr::filter(!nom_taxo %in% c(traits_macroinvertebres$nom_taxo %>% unique())) %>% View()
fun_select_NA(traits_macroinvertebres) %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith()
fun_select_NA(traits_macroinvertebres) %>% na.omit() %>% dplyr::select(-nom_taxo) %>% dudi.hillsmith() %>% biplot()
traits_macroinvertebres
fun_select_NA(traits_macroinvertebres) %>% na.omit() %>% dplyr::select(-c(nom_taxo,famille,genre)) %>% dudi.hillsmith() %>% biplot()
##########################################################################################################
########
########                                 OUVERTURE DES DONNEES
########
##########################################################################################################
source("/home/theo/Bureau/scriptR/librairies.R")
st_read("/home/theo/Bureau/Data/BV_lacs/BV_PE.shp")
sf::st_read("/home/theo/Bureau/Data/BV_lacs/BV_PE.shp")
?st_read
Encoding()
sf::st_read("/home/theo/Bureau/Data/BV_lacs/BV_PE_iso.shp")
sf::st_read("/home/theo/Bureau/Data/BV_lacs/BVE_PE_iso.shp")
a <- sf::st_read("/home/theo/Bureau/Data/BV_lacs/BVE_PE_iso.shp")
plot(a)
